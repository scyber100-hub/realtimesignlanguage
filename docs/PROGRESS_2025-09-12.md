# Progress Summary (2025-09-12)

This note captures the current state and the next steps to resume development quickly.

## Implemented
- Core pipeline (FastAPI)
  - `/text2gloss`, `/gloss2timeline`, `/ingest_text`
  - Incremental WS ingest `/ws/ingest` → `timeline`/`timeline.replace` broadcast
  - Timeline JSON schema with multi-channel (default/face/gaze)
- NLP/Rules
  - KO→KSL gloss (rule/lexicon), KR date/time/number normalization (incl. Sino-Korean)
- Streaming bridges
  - Vosk RTMP bridge, Whisper RTMP bridge (chunk/hop/beam params)
  - ASR WS stub `/ws/asr` (text JSON + PCM frames best‑effort Whisper hook)
  - WAV→WS streamer
- Dashboard (web, StaticFiles)
  - Live timeline canvas, latency p50/p90/p99 + histogram + sparkline
  - Replace ratio counters/sparkline, session table (meta, last_text_preview, replace_ratio_recent), filters, auto-refresh
  - Recent events viewer: `/events/recent`, `/events/summary`, `POST /events/clear`
  - Thresholds UI (p90 warn, replace warn, rate‑limit warn) → `POST /config/update`
  - Colorized badges for replace/latency/RL ratio
- Ops/metrics
  - Prometheus: request latency, ingest→broadcast histogram, WS clients, broadcast errors, sessions purged
  - Rate limiting per session (MAX_INGEST_RPS) + cumulative RL counters/ratio
  - Session TTL purge (SESSION_TTL_S)
- Lexicon management
  - Upload/update/snapshot/versions/rollback; audit log + `/lexicon/audit`
- Admin/config
  - `/config`, `/config/update`, `/stats`, `/healthz`, `/metrics`
- Tooling/tests
  - Mock streams, Vosk/Whisper bridges, WAV WS streamer, self-check, ingest bench
  - Basic tests for endpoints/diff/channels/normalize/events/sessions
  - Docker packaging + compose, .env loading

## Open Items (Next)
1) Streaming ASR quality (incremental)
   - Prefix/suffix preserving diff; debounce duplicate partials (framework in place) and tune
   - Optional Riva streaming integration, param surface and latency budget
2) Avatar/timeline polish
   - Safer replace within future window, prefetch window tuning; expand face/gaze patterns
   - Unity adapter: layer masks/blend quality, clip mapping UI
3) Domain accuracy
   - Expand domain lexicon (news/weather/disaster) and NER/templates
   - Explore rules+NMT hybrid for gloss
4) Ops/alerts
   - Stabilize badge updates (hysteresis/moving avg) and add session‑level p90/RL ratio
   - Grafana panels + Prometheus alert rules rollout
5) Broadcast pipeline
   - FFmpeg PiP quality presets; LL-HLS dual path; multi-session fan‑out

## How to Resume
- Run server: `powershell -ExecutionPolicy Bypass -File scripts/run_server.ps1`
- Open dashboard: `http://localhost:8000/` (set API key if configured)
- Try mock streaming: `python scripts/mock_asr_stream.py --text "안녕하세요 오늘 한국 날씨"`
- Optional Vosk/Whisper: see README “오프라인 ASR”/“Whisper” sections

## Reference
- Repo: https://github.com/scyber100-hub/realtimesignlanguage (master)
- Key docs: ARCHITECTURE.md, docs/FFMPEG_PIPELINES.md, docs/LATENCY_TUNING.md, docs/UNITY_ADAPTER.md, docs/UNITY_CHANNELS.md, docs/UNITY_PRESETS.md, docs/ALERTING.md

